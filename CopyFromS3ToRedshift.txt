COPY public.customer 
FROM 's3://pbi-aws-oregon-s3bucket-ct2hhrt6u0rd/tpch-data/customer/'
IAM_ROLE 'arn:aws:iam::447038024007:role/pbi-aws-oregon-RedshiftAccessRole-1F2XYJNTFGZIT';

COPY public.nation
FROM 's3://pbi-aws-oregon-s3bucket-ct2hhrt6u0rd/tpch-data/nation/'
IAM_ROLE 'arn:aws:iam::447038024007:role/pbi-aws-oregon-RedshiftAccessRole-1F2XYJNTFGZIT';

COPY public.part
FROM 's3://pbi-aws-oregon-s3bucket-ct2hhrt6u0rd/tpch-data/part/'
IAM_ROLE 'arn:aws:iam::447038024007:role/pbi-aws-oregon-RedshiftAccessRole-1F2XYJNTFGZIT';

COPY public.partsupp
FROM 's3://pbi-aws-oregon-s3bucket-ct2hhrt6u0rd/tpch-data/partsupp/'
IAM_ROLE 'arn:aws:iam::447038024007:role/pbi-aws-oregon-RedshiftAccessRole-1F2XYJNTFGZIT';

COPY public.region
FROM 's3://pbi-aws-oregon-s3bucket-ct2hhrt6u0rd/tpch-data/region/'
IAM_ROLE 'arn:aws:iam::447038024007:role/pbi-aws-oregon-RedshiftAccessRole-1F2XYJNTFGZIT';

COPY public.supplier
FROM 's3://pbi-aws-oregon-s3bucket-ct2hhrt6u0rd/tpch-data/supplier/'
IAM_ROLE 'arn:aws:iam::447038024007:role/pbi-aws-oregon-RedshiftAccessRole-1F2XYJNTFGZIT';

COPY public.orders
FROM 's3://pbi-aws-oregon-s3bucket-ct2hhrt6u0rd/tpch-data/orders/'
IAM_ROLE 'arn:aws:iam::447038024007:role/pbi-aws-oregon-RedshiftAccessRole-1F2XYJNTFGZIT';

COPY public.lineitem 
FROM 's3://pbi-aws-oregon-s3bucket-ct2hhrt6u0rd/tpch-data/lineitem/'
IAM_ROLE 'arn:aws:iam::447038024007:role/pbi-aws-oregon-RedshiftAccessRole-1F2XYJNTFGZIT';

SELECT COUNT(*) FROM public.customer; 
SELECT COUNT(*) FROM public.nation;
SELECT COUNT(*) FROM public.part;
SELECT COUNT(*) FROM public.partsupp;
SELECT COUNT(*) FROM public.region;
SELECT COUNT(*) FROM public.supplier;
SELECT COUNT(*) FROM public.orders;
SELECT COUNT(*) FROM public.lineitems;

SELECT n_name, COUNT(c_custkey) numOfCustomers
FROM nation n 
INNER JOIN customer c on n.n_nationkey = c.c_nationkey
GROUP BY n_name
ORDER BY n_name;